<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition template="/index.xhtml"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:c="http://java.sun.com/jsp/jstl/core">

	<h:head>
		<h:outputScript library="primefaces" name="jquery/jquery.js" />
		<h:outputScript library="primefaces" name="primefaces.js" />
		<link rel="stylesheet" type="text/css"
			href="resources/css/editarPerfil.css" />
		<link type="text/css" rel="stylesheet"
			href="https://cdn.jsdelivr.net/npm/primeflex@3.3.1/primeflex.min.css" />

	</h:head>

	<ui:define name="contenidoPrincipal">

		<div class="cont" style="display: grid; justify-content: center;">
			<div class="headerRegistro">
				<div class="textoHeader">
					<h1 class="mt-0" style="text-align-last: center;">EDITAR
						PERFIL</h1>
				</div>
			</div>
			<div class="box separador">
				<div class="surface-card p-4 shadow-2 border-round w-full">
					<div class="card " id="coso">
						<h:form>
							<p:growl id="messages" life="3000" closable="true"
								showDetail="true" />
							<p:fieldset id="grid" legend="Datos Personales"
								class="fildsetprueba">
								<div class="grid ui-fluid">
									<div class="col-12 md:col-4">
										<h5>Primer Nombre *</h5>

										<p:inputText id="primerNombre"
											value="#{gestionPersona.usuarioLogeado.nombre1}"
											required="true"
											requiredMessage="Debe ingresar el primer Nombre"
											maxlength="50"
											validatorMessage="No puede contener solo espacios vacios">
											<f:validateRegex pattern="^(?!\s*$).+"></f:validateRegex>
										</p:inputText>
										<small class="block ui-state-error"><h:message
												style="color:red;" for="primerNombre" /></small>

									</div>

									<div class="col-12 md:col-4">
										<h5>Segundo Nombre</h5>
										<p:inputText id="nombre2"
											value="#{gestionPersona.usuarioLogeado.nombre2}"
											validatorMessage="No puede contener solo espacios vacios">
											<f:validateRegex pattern="^(|\s*.*\S.*)$"></f:validateRegex>
										</p:inputText>
										<small class="block ui-state-error"><h:message
												style="color:red;" for="nombre2" /></small>
									</div>
									<div class="field col-12 md:col-4">
										<h5>Fecha Nacimiento *</h5>
										<p:datePicker id="spanish"
											value="#{gestionPersona.fechaNacLog}" locale="es"
											monthNavigator="true" pattern="dd-MM-yyyy"
											yearNavigator="true" yearRange="1950:2023" required="true"
											requiredMessage="Debe ingresar una fecha de nacimiento"
											validatorMessage="Formato incorrecto de la Fecha"
											styleClass="datePicker" />
										<small class="block ui-state-error"><h:message
												style="color:red;" for="spanish" /></small>

									</div>
								</div>
								<div class="grid ui-fluid">
									<div class="col-12 md:col-4">
										<h5>Primer Apellido *</h5>
										<p:inputText id="apellido1"
											value="#{gestionPersona.usuarioLogeado.apellido1}"
											required="true"
											requiredMessage="Debe ingresar el primer Apellido"
											validatorMessage="No puede contener solo espacios vacios">
											<f:validateRegex pattern="^(?!\s*$).+"></f:validateRegex>
										</p:inputText>
										<small class="block ui-state-error"><h:message
												style="color:red;" for="apellido1" /></small>
									</div>

									<div class="col-12 md:col-4">
										<h5>Segundo Apellido</h5>
										<p:inputText id="apellido2"
											value="#{gestionPersona.usuarioLogeado.apellido2}"
											validatorMessage="No puede contener solo espacios vacios">
											<f:validateRegex pattern="^(|\s*.*\S.*)$"></f:validateRegex>
										</p:inputText>
										<small class="block ui-state-error"><h:message
												style="color:red;" for="apellido2" /></small>
									</div>
									<div class="field col-12 md:col-4">
										<h5>Localidad *</h5>
										<p:inputText id="localidad"
											value="#{gestionPersona.usuarioLogeado.localidad}"
											required="true" requiredMessage="Debe ingresar la Direccion"
											validatorMessage="No puede contener solo espacios vacios">
											<f:validateRegex pattern="^(?!\s*$).+"></f:validateRegex>
										</p:inputText>
										<small class="block ui-state-error"><h:message
												style="color:red;" for="localidad" /></small>
									</div>
									<div class="field col-12 md:col-4">
										<h5>Documento *</h5>
										<p:inputText id="documento"
											value="#{gestionPersona.usuarioLogeado.documento}"
											validatorMessage="No puede contener solo espacios vacios">
											<f:validateRegex pattern="^(|\s*.*\S.*)$"></f:validateRegex>

										</p:inputText>
										<small class="block ui-state-error"><h:message
												style="color:red;" for="documento" /></small>

									</div>
									<div class="field col-12 md:col-4">
										<h5>Telefono *</h5>
										<p:inputText id="telefono"
											value="#{gestionPersona.usuarioLogeado.telefono}"
											required="true" requiredMessage="Debe ingresar el telefono"
											validatorMessage="No puede contener solo espacios vacios">
											<f:validateRegex pattern="^(?!\s*$).+"></f:validateRegex>

										</p:inputText>
										<small class="block ui-state-error"><h:message
												style="color:red;" for="telefono" /></small>
									</div>

									<div class="col-12 md:col-4">
										<h5>Departamento *</h5>
										<p:selectOneMenu id="groupDep"
											value="#{gestionPersona.depSeleccionadoLog}"
											validatorMessage="Debe Seleccionar una opcion">
											<f:selectItem itemLabel="Selecciona uno" itemValue="" />
											<c:forEach var="dep" items="#{gestionPersona.departamentos}">
												<f:selectItem itemLabel="#{dep.nombre}"
													itemValue="#{dep.nombre}" />
											</c:forEach>

											<f:validateRequired></f:validateRequired>
										</p:selectOneMenu>
										<small class="block ui-state-error"><h:message
												style="color:red;" for="groupDep" /></small>
									</div>
								</div>

								<div class="grid ui-fluid"></div>


							</p:fieldset>
							<p:fieldset id="grid2" legend="Datos Usuario"
								class="fildsetprueba">
								<div class="grid ui-fluid">


									<div class="col-12 md:col-4">
										<h5>Email *</h5>
										<p:inputText id="email1"
											value="#{gestionPersona.usuarioLogeado.mail}" required="true"
											requiredMessage="Debe ingresar el Email" type="email"
											validatorMessage="Formato de Email incorrecto">
											<f:validateRegex
												pattern="^[_A-Za-z0-9-\+]+(\.[_A-Za-z0-9-]+)*@[A-Za-z0-9-]+(\.[A-Za-z0-9]+)*(\.[A-Za-z]{2,})$"></f:validateRegex>
										</p:inputText>
										<small class="block ui-state-error"><h:message
												style="color:red;" for="email1" /></small>
									</div>

									<div class="col-12 md:col-4">
										<h5>Email Instutucional *</h5>
										<p:inputText id="email2"
											value="#{gestionPersona.usuarioLogeado.mailInstitucional}"
											required="true" requiredMessage="Debe ingresar el Email"
											type="email" validatorMessage="Formato de Email incorrecto">
											<f:validateRegex
												pattern="^[_A-Za-z0-9-\+]+(\.[_A-Za-z0-9-]+)*@[A-Za-z0-9-]+(\.[A-Za-z0-9]+)*(\.[A-Za-z]{2,})$"></f:validateRegex>

										</p:inputText>
										<small class="block ui-state-error"><h:message
												style="color:red;" for="email2" /></small>
									</div>

									<div class="col-12 md:col-4">
										<h5>ITR *</h5>
										<p:selectOneMenu id="groupItr"
											value="#{gestionPersona.itrSeleccionadoLog}"
											validatorMessage="Debe Seleccionar una opcion">
											<f:selectItem itemLabel="Selecciona uno" itemValue="" />
											<c:forEach var="itr" items="#{gestionPersona.itrs}">
												<f:selectItem itemLabel="#{itr.nombre}"
													itemValue="#{itr.nombre}" />
											</c:forEach>

											<f:validateRequired></f:validateRequired>
										</p:selectOneMenu>
										<small class="block ui-state-error"><h:message
												style="color:red;" for="groupItr" /></small>
									</div>
								</div>





								<div class="col-12 md:col-4">
									<p:commandButton value="Cambiar Contraseña"
										action="#{gestionPersona.toggleModContrasena}"
										update="modContrasena" immediate="true">
									</p:commandButton>
								</div>

								<h:panelGroup id="modContrasena" layout="block">

									<p:outputPanel rendered="#{gestionPersona.modContraseña}">
										<p:fieldset class="fildsetprueba">
											<div class="grid ui-fluid">
												<div class="col-12 md:col-4">
													<h5>Contraseña *</h5>
													<p:password id="pass" label="Contraseña" match="pass2"
														feedback="false"
														value="#{gestionPersona.contrasenaModificar}"
														validatorMessage="Las Contraseñas no coinciden"
														required="true" requiredMessage="Se necesita una valor">
														<f:validateLength minimum="8" maximum="16"></f:validateLength>
													</p:password>
													<small class="block ui-state-error"><h:message
															style="color:red;" for="pass" /></small>

												</div>
												<div class="col-12 md:col-4">
													<h5>Confirmar Contraseña *</h5>
													<p:password id="pass2" label="Confirmar Contraseña"
														feedback="false"
														value="#{gestionPersona.contrasenaModificar}"
														required="true"
														requiredMessage="Debe ingresar una Contraseña" />
													<small class="block ui-state-error"><h:message
															style="color:red;" for="pass2" /></small>
												</div>

											</div>
											<div class="grid ui-fluid col-8">
												<div class="col-12 md:col-4">
													<p:commandButton value="Cancelar"
														styleClass="ui-button-raised ui-button-flat"
														action="#{gestionPersona.toggleModContrasena}"
														update="modContrasena" immediate="true" />
												</div>
												<div class="col-12 md:col-4">

													<p:commandButton value="Guardar"
														styleClass="ui-button-raised"
														action="#{gestionPersona.modificarContrasena}"
														update="modContrasena messages grid grid2" />
												</div>




											</div>
										</p:fieldset>
									</p:outputPanel>

								</h:panelGroup>


							</p:fieldset>


							<p:fieldset id="grid3" legend="Datos Estudiante"
								class="fildsetprueba"
								rendered="#{gestionPersona.esEstudianteLogeado()}">

								<h:panelGroup id="datosAlumno" layout="block">
									<p:outputPanel>
										<div class="grid ui-fluid" id="datosAlumno">
											<div class="col-12 md:col-4">
												<h5>Año de ingreso *</h5>
												<p:inputText id="anoIngreso" type="number"
													value="#{gestionPersona.anoIngresoLog}"
													requiredMessage="Debe ingresar el Id Estudiantil"
													required="true">

												</p:inputText>
												<small class="block ui-state-error"><h:message
														style="color:red;" for="anoIngreso" /></small>
											</div>
										</div>
									</p:outputPanel>
								</h:panelGroup>
							</p:fieldset>

							<p:fieldset id="grid4" legend="Datos Tutor" class="fildsetprueba"
								rendered="#{gestionPersona.esTutorLogeado()}">

								<h:panelGroup id="datosTutor" layout="block">
									<p:outputPanel>
										<div class="grid ui-fluid" id="datosTutor">
											<div class="col-12 md:col-4">
												<h5>Area Tutor *</h5>
												<p:selectOneMenu id="groupAreaTutor"
													value="#{gestionPersona.areaTutorLog}"
													validatorMessage="Debe Seleccionar una opcion">
													<f:selectItem itemLabel="Selecciona uno" itemValue="" />
													<c:forEach var="areas" items="#{gestionPersona.areasTutor}">
														<f:selectItem itemLabel="#{areas.nombre}"
															itemValue="#{areas.nombre}" />
													</c:forEach>

													<f:validateRequired></f:validateRequired>
												</p:selectOneMenu>
												<small class="block ui-state-error"><h:message
														style="color:red;" for="groupAreaTutor" /></small>
											</div>

											<div class="col-12 md:col-4">
												<h5>Rol *</h5>
												<p:selectOneMenu id="groupRol"
													value="#{gestionPersona.rolTutorLog}"
													validatorMessage="Debe Seleccionar una opcion">
													<f:selectItem itemLabel="Selecciona uno" itemValue="" />
													<c:forEach var="rol" items="#{gestionPersona.rolesTutor}">
														<f:selectItem itemLabel="#{rol.nombre}"
															itemValue="#{rol.nombre}" />
													</c:forEach>
													<f:validateRequired></f:validateRequired>
												</p:selectOneMenu>
												<small class="block ui-state-error"><h:message
														style="color:red;" for="groupRol" /></small>
											</div>
										</div>
									</p:outputPanel>
								</h:panelGroup>
							</p:fieldset>

							<div>
								<div class="flex card-container">
									<div
										class="flex-none flex align-items-center justify-content-center">


									</div>

									<div
										class="flex-grow-1 flex align-items-center justify-content-center "></div>
									<div
										class="flex-none flex align-items-center justify-content-center">
										<p:commandButton value="Guardar Cambios"
											action="#{gestionPersona.modificarUsuario()}"
											update="grid grid2 messages">
											<p:confirm header="Estas Seguro?"
												message="Los datos modificados quedaran guardados"
												icon="pi pi-info-circle" />
										</p:commandButton>
									</div>


								</div>
							</div>



							<p:outputPanel id="confirmDialogContainer" styleClass="cont">
								<p:confirmDialog global="true" showEffect="fade"
									hideEffect="fade" responsive="true" width="350" class="dialog"
									appendTo="confirmDialogContainer" id="k"
									styleClass="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);">
									<p:commandButton value="No" type="button"
										styleClass="ui-confirmdialog-no ui-button-flat" />
									<p:commandButton value="Sí" type="button"
										styleClass="ui-confirmdialog-yes" />
								</p:confirmDialog>
							</p:outputPanel>


							<p:confirmDialog global="true" showEffect="fade"
								hideEffect="fade" responsive="true" width="350"
								widgetVar="confirm" header="Estas Seguro?">
								<p:commandButton value="Cancelar" type="button"
									styleClass="ui-confirmdialog-no ui-button-flat" />
								<p:commandButton value="Confirmar" type="button"
									styleClass="ui-confirmdialog-yes" />
							</p:confirmDialog>
						</h:form>

					</div>
				</div>
			</div>
		</div>
	</ui:define>

</ui:composition>
