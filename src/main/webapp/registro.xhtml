<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:c="http://java.sun.com/jsp/jstl/core">
	
	
	
	

<h:head>
	<h:outputScript library="primefaces" name="jquery/jquery.js" />
	<h:outputScript library="primefaces" name="primefaces.js" />
	<link type="text/css" rel="stylesheet"
		href="https://cdn.jsdelivr.net/npm/primeflex@3.3.1/primeflex.min.css" />
	<link rel="stylesheet" type="text/css"
		href="resources/css/registro.css" />
</h:head>
<body>

	<!--****************************************	Header	  **************************************** -->
	<div class="headerRegistro">
		<div class="textoHeader">
			<h1 class="mt-0">REGISTRO DE USUARIO</h1>
		</div>
	</div>
	<!--**************************************** 	Fin Header    ****************************************-->

	<!--**************************************** 	Registro    ****************************************-->
	<div class="box separador">
		<div class="surface-card p-4 shadow-2 border-round w-full lg:w-6">
			<div class="card ">
				<h:form>
					<p:growl id="messages" life="3000" closable="true" />
					<p:fieldset id="grid" legend="Datos Personales"
						class="fildsetprueba">
						<div class="grid ui-fluid">
							<div class="col-12 md:col-4">
								<h5>Primer Nombre *</h5>

								<p:inputText id="primerNombre"
									value="#{gestionPersona.personaSeleccionada.nombre1}"
									required="true"
									requiredMessage="Debe ingresar el primer Nombre" maxlength="50"
									validatorMessage="No puede contener solo espacios vacios">
									<f:validateRegex pattern="^(?!\s*$).+"></f:validateRegex>

								</p:inputText>
								<small class="block ui-state-error"><h:message
										style="color:red;" for="primerNombre" /></small>

							</div>

							<div class="col-12 md:col-4">
								<h5>Segundo Nombre</h5>
								<p:inputText id="nombre2"
									value="#{gestionPersona.personaSeleccionada.nombre2}"
									maxlength="50"
									validatorMessage="No puede contener solo espacios vacios">
									<f:validateRegex pattern="^(|\s*.*\S.*)$"></f:validateRegex>

								</p:inputText>
								<small class="block ui-state-error"><h:message
										style="color:red;" for="nombre2" /></small>
							</div>
							<div class="field col-12 md:col-4">
								<h5>Fecha Nacimiento *</h5>
								<p:datePicker id="spanish" value="#{gestionPersona.fechaNacSel}"
									locale="es" monthNavigator="true" pattern="dd-MM-yyyy"
									yearNavigator="true" yearRange="1950:2023" required="true"
									requiredMessage="Debe ingresar una fecha de nacimiento"
									validatorMessage="Formato incorrecto de la Fecha o no es mayor de edad"
									maxdate="#{gestionPersona.fecMayoriaEdad()}">
								</p:datePicker>
								<small class="block ui-state-error"><h:message
										style="color:red;" for="spanish" /></small>
							</div>
						</div>
						<div class="grid ui-fluid">
							<div class="col-12 md:col-4">
								<h5>Primer Apellido *</h5>
								<p:inputText id="apellido1"
									value="#{gestionPersona.personaSeleccionada.apellido1}"
									required="true"
									maxlength="50"
									requiredMessage="Debe ingresar el primer Apellido"
									validatorMessage="No puede contener solo espacios vacios">
									<f:validateRegex pattern="^(?!\s*$).+"></f:validateRegex>

								</p:inputText>
								<small class="block ui-state-error"><h:message
										style="color:red;" for="apellido1" /></small>
							</div>

							<div class="col-12 md:col-4">
								<h5>Segundo Apellido</h5>
								<p:inputText id="apellido2"
									maxlength="50"
									value="#{gestionPersona.personaSeleccionada.apellido2}"
									validatorMessage="No puede contener solo espacios vacios">
									<f:validateRegex pattern="^(|\s*.*\S.*)$"></f:validateRegex>
								</p:inputText>
								<small class="block ui-state-error"><h:message
										style="color:red;" for="apellido2" /></small>
							</div>
							<div class="field col-12 md:col-4">
								<h5>Localidad *</h5>
								<p:inputText id="localidad"
									value="#{gestionPersona.personaSeleccionada.localidad}"
									required="true" requiredMessage="Debe ingresar la Direccion"
									maxlength="50"
									validatorMessage="No puede contener solo espacios vacios">
									<f:validateRegex pattern="^(?!\s*$).+"></f:validateRegex>

								</p:inputText>
								<small class="block ui-state-error"><h:message
										style="color:red;" for="localidad" /></small>
							</div>
							
								<div class="field col-12 md:col-4">
									<h5>Documento *</h5>
									<p:inputText id="documento"
										value="#{gestionPersona.personaSeleccionada.documento}"
										maxlength="8"
										required="true"
										requiredMessage="Debe ingresar el Documento"
										validatorMessage="No puede contener solo espacios vacios">
										<p:keyFilter for="documento" mask="pnum" />
										<f:validateRegex pattern="^(?!\s*$)\d+$"></f:validateRegex>
									</p:inputText>
									<small class="block ui-state-error"><h:message
											style="color:red;" for="documento" />
									</small>
								</div>
						
						
							<div class="field col-12 md:col-4">
								<h5>Telefono *</h5>
								<p:inputText id="telefono"
									value="#{gestionPersona.personaSeleccionada.telefono}"
									required="true" requiredMessage="Debe ingresar el telefono"
									maxlength="50"
									validatorMessage="No puede contener solo espacios vacios">
									<f:validateRegex pattern="^(?!\s*$).+"></f:validateRegex>
									<p:keyFilter for="telefono" mask="pint" />

								</p:inputText>
								<small class="block ui-state-error"><h:message
										style="color:red;" for="telefono" /></small>
							</div>

							<div class="col-12 md:col-4">
								<h5>Departamento *</h5>
								<p:selectOneMenu id="groupDep"
									value="#{gestionPersona.departamentoSeleccionado}"
									validatorMessage="Debe Seleccionar una opcion">
									<f:selectItem itemLabel="Selecciona uno" itemValue="" />
									<c:forEach var="dep" items="#{gestionPersona.departamentos}">
										<f:selectItem itemLabel="#{dep.nombre}"
											itemValue="#{dep.nombre}" />
									</c:forEach>

									<f:validateRequired></f:validateRequired>
								</p:selectOneMenu>
								<small class="block ui-state-error"><h:message
										style="color:red;" for="groupDep" /></small>
							</div>

						</div>

						<div class="grid ui-fluid"></div>


					</p:fieldset>
					<p:fieldset id="grid2" legend="Datos Usuario" class="fildsetprueba">
						<div class="grid ui-fluid">


							<div class="col-12 md:col-4">
								<h5>Email *</h5>
								<p:inputText id="email1"
									value="#{gestionPersona.personaSeleccionada.mail}"
									required="true" requiredMessage="Debe ingresar el Email"
									maxlength="50"
									type="email"
									validatorMessage="Formato de Email incorrecto">
									<f:validateRegex
										pattern="^[_A-Za-z0-9-\+]+(\.[_A-Za-z0-9-]+)*@[A-Za-z0-9-]+(\.[A-Za-z0-9]+)*(\.[A-Za-z]{2,})$"></f:validateRegex>
								</p:inputText>
								
								<small class="block ui-state-error"><h:message
										style="color:red;" for="email1" /></small>
							</div>
							<div class="col-12 md:col-4">
								<h5>Email Instutucional *</h5>
								<p:inputText id="email2"
									value="#{gestionPersona.personaSeleccionada.mailInstitucional}"
									required="true" requiredMessage="Debe ingresar el Email Institucional"
									maxlength="50"
									validator="#{validatorPersona.validate}"
									type="email">

								</p:inputText>
								<small class="block ui-state-error"><h:message
										style="color:red;" for="email2" /></small>
							</div>
						</div>
						<div class="grid ui-fluid">
							<div class="col-12 md:col-4">
								<h5>Contraseña *</h5>
								<p:password id="pass" label="Contraseña" match="pass2"
									feedback="false"
									value="#{gestionPersona.personaSeleccionada.contrasena}"
									
									required="true" requiredMessage="Se necesita una contraseña"
									validator="#{validatorContrasena.validate}">	
								</p:password>
								<small class="block ui-state-error"><h:message
										style="color:red;" for="pass" /></small>

							</div>
							<div class="col-12 md:col-4">
								<h5>Confirmar Contraseña *</h5>
								<p:password id="pass2" label="Confirmar Contraseña"
									feedback="false"
									value="#{gestionPersona.personaSeleccionada.contrasena}"
									required="true" requiredMessage="Debe confirmar la contraseña" />
								<small class="block ui-state-error"><h:message
										style="color:red;" for="pass2" /></small>
							</div>
							<div class="col-12 md:col-4">
								<h5>ITR *</h5>
								<p:selectOneMenu id="groupItr"
									value="#{gestionPersona.itrSeleccionado}"
									validatorMessage="Debe Seleccionar una opcion"
									converter="omnifaces.SelectItemsConverter">
									<f:selectItem itemLabel="Selecciona uno" itemValue="" />
									<c:forEach var="itr" items="#{gestionPersona.itrs}">
										<f:selectItem itemLabel="#{itr.nombre}"
											itemValue="#{itr.nombre}" />
									</c:forEach>

									<f:validateRequired></f:validateRequired>
								</p:selectOneMenu>
								<small class="block ui-state-error"><h:message
										style="color:red;" for="groupItr" /></small>
							</div>
						</div>
					</p:fieldset>


					<p:fieldset id="grid3" legend="Datos Alumno" class="fildsetprueba">
						<div class="grid ui-fluid">
							<div class="col-12 md:col-4">
								<h5>Tipo de Usuario *</h5>

								<p:selectOneMenu id="isEstudiante" required="true"
									value="#{gestionPersona.tipoUsuario}">
									<p:ajax update="datosAlumno datosDocente" process="@this"
										event="change" />



									<f:selectItem itemLabel="Selecciona uno" itemValue="" />
									<f:selectItem itemLabel="Estudiante" itemValue="estudiante" />
									<f:selectItem itemLabel="Analista" itemValue="analista" />
									<f:selectItem itemLabel="Docente" itemValue="docente" />


								</p:selectOneMenu>


							</div>
						</div>
						<h:panelGroup id="datosAlumno" layout="block">
							<p:outputPanel rendered="#{gestionPersona.esEstudiante()}">
								<div class="grid ui-fluid" id="datosAlumno">
									<div class="col-12 md:col-4">
										<h5>Año de ingreso *</h5>
										<p:inputText id="anoIngreso" type="number"
											value="#{gestionPersona.anoIngresoSeleccionado}"
											validator="#{validatorEstudiante.validate}"
											requiredMessage="Debe ingresar el Año de Ingreso"
											required="true">
										</p:inputText>
										<small class="block ui-state-error"><h:message
												style="color:red;" for="anoIngreso" /></small>
									</div>
								</div>
							</p:outputPanel>
						</h:panelGroup>
						<h:panelGroup id="datosDocente" layout="block">
							<p:outputPanel rendered="#{gestionPersona.esDocente()}">
								<div class="grid ui-fluid" id="datosAlumno">
									<div class="col-12 md:col-4">
										<h5>Area Tutor *</h5>
										<p:selectOneMenu id="groupAreaTutor"
											value="#{gestionPersona.areaTutorSeleccionado}"
											validatorMessage="Debe Seleccionar una opcion">
											<f:selectItem itemLabel="Selecciona uno" itemValue="" />
											<c:forEach var="areas" items="#{gestionPersona.areasTutor}">
												<f:selectItem itemLabel="#{areas.nombre}"
													itemValue="#{areas.nombre}" />
											</c:forEach>

											<f:validateRequired></f:validateRequired>
										</p:selectOneMenu>
										<small class="block ui-state-error"><h:message
												style="color:red;" for="groupAreaTutor" /></small>
									</div>

									<div class="col-12 md:col-4">
										<h5>Rol *</h5>
										<p:selectOneMenu id="groupRol"
											value="#{gestionPersona.rolTutorSeleccionado}"
											validatorMessage="Debe Seleccionar una opcion">
											<f:selectItem itemLabel="Selecciona uno" itemValue="" />
											<c:forEach var="rol" items="#{gestionPersona.rolesTutor}">
												<f:selectItem itemLabel="#{rol.nombre}"
													itemValue="#{rol.nombre}" />
											</c:forEach>
											<f:validateRequired></f:validateRequired>
										</p:selectOneMenu>
										<small class="block ui-state-error"><h:message
												style="color:red;" for="groupRol" /></small>
									</div>
								</div>
							</p:outputPanel>
						</h:panelGroup>
					</p:fieldset>


					<div>
						<div class="flex card-container">
							<div
								class="flex-none flex align-items-center justify-content-center">
								<p:commandButton value="Cancelar"
									styleClass="ui-button-raised  ui-button-flat"
									action="login.xhtml" immediate="true" />
							</div>

							<div
								class="flex-grow-1 flex align-items-center justify-content-center "></div>
							<div
								class="flex-none flex align-items-center justify-content-center">
								<p:commandButton value="Guardar"
									action="#{gestionPersona.agregarUsuario()}" update="grid grid2 datosAlumno datosDocente" >
									<p:confirm header="Aviso" message="Su solicitud de registro queda a la espera de validación." icon="pi pi-exclamation-triangle"/>
								</p:commandButton>
								
									
							</div>
						</div>
					</div>
					 <p:confirmDialog global="true" showEffect="fade" hideEffect="fade" responsive="true" width="350">					          
					            <p:commandButton value="Entendido" type="button" styleClass="ui-confirmdialog-yes" />
					 </p:confirmDialog>
				</h:form>
			</div>
		</div>
	</div>
	
	<!--**************************************** 	Fin Registro    ****************************************-->

	<!--**************************************** 	Footer    ****************************************-->
	<ui:include src="templates/footer.xhtml" />
	<!--**************************************** 	Fin Footer    ****************************************-->
</body>
</html>




